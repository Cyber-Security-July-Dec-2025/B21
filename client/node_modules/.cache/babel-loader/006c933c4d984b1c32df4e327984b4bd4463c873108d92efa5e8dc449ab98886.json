{"ast":null,"code":"// crypto.js - WebCrypto helpers\n\n// ------------------- Conversion Helpers -------------------\nexport function hexToArrayBuffer(hex) {\n  if (!hex) return new ArrayBuffer(0);\n  const clean = hex.replace(/\\s+/g, '');\n  const len = clean.length / 2;\n  const u8 = new Uint8Array(len);\n  for (let i = 0; i < len; i++) {\n    u8[i] = parseInt(clean.substr(i * 2, 2), 16);\n  }\n  return u8.buffer;\n}\nexport function arrayBufferToHex(buffer) {\n  const bytes = new Uint8Array(buffer);\n  return Array.from(bytes, b => b.toString(16).padStart(2, '0')).join('');\n}\nexport function arrayBufferToBase64(arrayBuffer) {\n  const bytes = new Uint8Array(arrayBuffer);\n  let binary = '';\n  for (let i = 0; i < bytes.byteLength; i++) {\n    binary += String.fromCharCode(bytes[i]);\n  }\n  return btoa(binary);\n}\nexport function base64ToArrayBuffer(base64) {\n  const binary = atob(base64);\n  const len = binary.length;\n  const bytes = new Uint8Array(len);\n  for (let i = 0; i < len; i++) {\n    bytes[i] = binary.charCodeAt(i);\n  }\n  return bytes.buffer;\n}\n\n// ------------------- AES Helpers -------------------\n// Generate AES-256-GCM key\nexport async function generateAESKey() {\n  return await crypto.subtle.generateKey({\n    name: 'AES-GCM',\n    length: 256\n  }, true, ['encrypt', 'decrypt']);\n}\n\n// Export AES raw bytes\nexport async function exportAESRaw(key) {\n  return await crypto.subtle.exportKey('raw', key);\n}\n\n// Import raw AES key from ArrayBuffer\nexport async function importAESRaw(raw) {\n  return await crypto.subtle.importKey('raw', raw, {\n    name: 'AES-GCM'\n  }, true, ['encrypt', 'decrypt']);\n}\n\n// AES-GCM encrypt: returns { ciphertext: ArrayBuffer, iv: Uint8Array }\nexport async function aesGcmEncrypt(aesKey, dataArrayBuffer) {\n  const iv = crypto.getRandomValues(new Uint8Array(12)); // 12 bytes recommended\n  const ciphertext = await crypto.subtle.encrypt({\n    name: 'AES-GCM',\n    iv\n  }, aesKey, dataArrayBuffer);\n  return {\n    ciphertext,\n    iv\n  };\n}\n\n// AES-GCM decrypt\nexport async function aesGcmDecrypt(aesKey, ivUint8, ciphertextArrayBuffer) {\n  return await crypto.subtle.decrypt({\n    name: 'AES-GCM',\n    iv: ivUint8\n  }, aesKey, ciphertextArrayBuffer);\n}\n\n// ------------------- RSA Helpers -------------------\n// Import RSA public key from HEX (SPKI DER)\nexport async function importRSAPublicKeyHex(pubHex) {\n  const spki = hexToArrayBuffer(pubHex);\n  return await crypto.subtle.importKey('spki', spki, {\n    name: 'RSA-OAEP',\n    hash: 'SHA-256'\n  }, false, ['encrypt']);\n}\n\n// Import RSA public key from Base64 (SPKI DER)\nexport async function importRSAPublicKeyBase64(pubBase64) {\n  const spki = base64ToArrayBuffer(pubBase64);\n  return await crypto.subtle.importKey('spki', spki, {\n    name: 'RSA-OAEP',\n    hash: 'SHA-256'\n  }, false, ['encrypt']);\n}\n\n// Import RSA private key from HEX (PKCS8 DER)\nexport async function importRSAPrivateKeyHex(privHex) {\n  const pkcs8 = hexToArrayBuffer(privHex);\n  return await crypto.subtle.importKey('pkcs8', pkcs8, {\n    name: 'RSA-OAEP',\n    hash: 'SHA-256'\n  }, false, ['decrypt']);\n}\n\n// ✅ Import RSA private key from Base64 (PKCS8 DER)\nexport async function importRSAPrivateKeyBase64(privBase64) {\n  const pkcs8 = base64ToArrayBuffer(privBase64);\n  return await crypto.subtle.importKey('pkcs8', pkcs8, {\n    name: 'RSA-OAEP',\n    hash: 'SHA-256'\n  }, false, ['decrypt']);\n}\n\n// RSA encrypt raw AES key (ArrayBuffer) -> ArrayBuffer\nexport async function rsaEncrypt(publicKey, rawAESArrayBuffer) {\n  return await crypto.subtle.encrypt({\n    name: 'RSA-OAEP'\n  }, publicKey, rawAESArrayBuffer);\n}\n\n// RSA decrypt -> raw AES bytes\nexport async function rsaDecrypt(privateKey, encrypted) {\n  return await crypto.subtle.decrypt({\n    name: 'RSA-OAEP'\n  }, privateKey, encrypted);\n}\n\n// ------------------- Digest -------------------\n// Compute SHA-256 digest of an ArrayBuffer -> ArrayBuffer(32 bytes)\nexport async function sha256(arrayBuffer) {\n  return await crypto.subtle.digest('SHA-256', arrayBuffer);\n}","map":{"version":3,"names":["hexToArrayBuffer","hex","ArrayBuffer","clean","replace","len","length","u8","Uint8Array","i","parseInt","substr","buffer","arrayBufferToHex","bytes","Array","from","b","toString","padStart","join","arrayBufferToBase64","arrayBuffer","binary","byteLength","String","fromCharCode","btoa","base64ToArrayBuffer","base64","atob","charCodeAt","generateAESKey","crypto","subtle","generateKey","name","exportAESRaw","key","exportKey","importAESRaw","raw","importKey","aesGcmEncrypt","aesKey","dataArrayBuffer","iv","getRandomValues","ciphertext","encrypt","aesGcmDecrypt","ivUint8","ciphertextArrayBuffer","decrypt","importRSAPublicKeyHex","pubHex","spki","hash","importRSAPublicKeyBase64","pubBase64","importRSAPrivateKeyHex","privHex","pkcs8","importRSAPrivateKeyBase64","privBase64","rsaEncrypt","publicKey","rawAESArrayBuffer","rsaDecrypt","privateKey","encrypted","sha256","digest"],"sources":["C:/Users/new/secure-file-vault/client/src/utils/crypto.js"],"sourcesContent":["// crypto.js - WebCrypto helpers\r\n\r\n// ------------------- Conversion Helpers -------------------\r\nexport function hexToArrayBuffer(hex) {\r\n  if (!hex) return new ArrayBuffer(0);\r\n  const clean = hex.replace(/\\s+/g, '');\r\n  const len = clean.length / 2;\r\n  const u8 = new Uint8Array(len);\r\n  for (let i = 0; i < len; i++) {\r\n    u8[i] = parseInt(clean.substr(i * 2, 2), 16);\r\n  }\r\n  return u8.buffer;\r\n}\r\n\r\nexport function arrayBufferToHex(buffer) {\r\n  const bytes = new Uint8Array(buffer);\r\n  return Array.from(bytes, b => b.toString(16).padStart(2, '0')).join('');\r\n}\r\n\r\nexport function arrayBufferToBase64(arrayBuffer) {\r\n  const bytes = new Uint8Array(arrayBuffer);\r\n  let binary = '';\r\n  for (let i = 0; i < bytes.byteLength; i++) {\r\n    binary += String.fromCharCode(bytes[i]);\r\n  }\r\n  return btoa(binary);\r\n}\r\n\r\nexport function base64ToArrayBuffer(base64) {\r\n  const binary = atob(base64);\r\n  const len = binary.length;\r\n  const bytes = new Uint8Array(len);\r\n  for (let i = 0; i < len; i++) {\r\n    bytes[i] = binary.charCodeAt(i);\r\n  }\r\n  return bytes.buffer;\r\n}\r\n\r\n// ------------------- AES Helpers -------------------\r\n// Generate AES-256-GCM key\r\nexport async function generateAESKey() {\r\n  return await crypto.subtle.generateKey(\r\n    { name: 'AES-GCM', length: 256 },\r\n    true,\r\n    ['encrypt', 'decrypt']\r\n  );\r\n}\r\n\r\n// Export AES raw bytes\r\nexport async function exportAESRaw(key) {\r\n  return await crypto.subtle.exportKey('raw', key);\r\n}\r\n\r\n// Import raw AES key from ArrayBuffer\r\nexport async function importAESRaw(raw) {\r\n  return await crypto.subtle.importKey('raw', raw, { name: 'AES-GCM' }, true, ['encrypt', 'decrypt']);\r\n}\r\n\r\n// AES-GCM encrypt: returns { ciphertext: ArrayBuffer, iv: Uint8Array }\r\nexport async function aesGcmEncrypt(aesKey, dataArrayBuffer) {\r\n  const iv = crypto.getRandomValues(new Uint8Array(12)); // 12 bytes recommended\r\n  const ciphertext = await crypto.subtle.encrypt({ name: 'AES-GCM', iv }, aesKey, dataArrayBuffer);\r\n  return { ciphertext, iv };\r\n}\r\n\r\n// AES-GCM decrypt\r\nexport async function aesGcmDecrypt(aesKey, ivUint8, ciphertextArrayBuffer) {\r\n  return await crypto.subtle.decrypt({ name: 'AES-GCM', iv: ivUint8 }, aesKey, ciphertextArrayBuffer);\r\n}\r\n\r\n// ------------------- RSA Helpers -------------------\r\n// Import RSA public key from HEX (SPKI DER)\r\nexport async function importRSAPublicKeyHex(pubHex) {\r\n  const spki = hexToArrayBuffer(pubHex);\r\n  return await crypto.subtle.importKey(\r\n    'spki',\r\n    spki,\r\n    { name: 'RSA-OAEP', hash: 'SHA-256' },\r\n    false,\r\n    ['encrypt']\r\n  );\r\n}\r\n\r\n// Import RSA public key from Base64 (SPKI DER)\r\nexport async function importRSAPublicKeyBase64(pubBase64) {\r\n  const spki = base64ToArrayBuffer(pubBase64);\r\n  return await crypto.subtle.importKey(\r\n    'spki',\r\n    spki,\r\n    { name: 'RSA-OAEP', hash: 'SHA-256' },\r\n    false,\r\n    ['encrypt']\r\n  );\r\n}\r\n\r\n// Import RSA private key from HEX (PKCS8 DER)\r\nexport async function importRSAPrivateKeyHex(privHex) {\r\n  const pkcs8 = hexToArrayBuffer(privHex);\r\n  return await crypto.subtle.importKey(\r\n    'pkcs8',\r\n    pkcs8,\r\n    { name: 'RSA-OAEP', hash: 'SHA-256' },\r\n    false,\r\n    ['decrypt']\r\n  );\r\n}\r\n\r\n// ✅ Import RSA private key from Base64 (PKCS8 DER)\r\nexport async function importRSAPrivateKeyBase64(privBase64) {\r\n  const pkcs8 = base64ToArrayBuffer(privBase64);\r\n  return await crypto.subtle.importKey(\r\n    'pkcs8',\r\n    pkcs8,\r\n    { name: 'RSA-OAEP', hash: 'SHA-256' },\r\n    false,\r\n    ['decrypt']\r\n  );\r\n}\r\n\r\n// RSA encrypt raw AES key (ArrayBuffer) -> ArrayBuffer\r\nexport async function rsaEncrypt(publicKey, rawAESArrayBuffer) {\r\n  return await crypto.subtle.encrypt({ name: 'RSA-OAEP' }, publicKey, rawAESArrayBuffer);\r\n}\r\n\r\n// RSA decrypt -> raw AES bytes\r\nexport async function rsaDecrypt(privateKey, encrypted) {\r\n  return await crypto.subtle.decrypt({ name: 'RSA-OAEP' }, privateKey, encrypted);\r\n}\r\n\r\n// ------------------- Digest -------------------\r\n// Compute SHA-256 digest of an ArrayBuffer -> ArrayBuffer(32 bytes)\r\nexport async function sha256(arrayBuffer) {\r\n  return await crypto.subtle.digest('SHA-256', arrayBuffer);\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}